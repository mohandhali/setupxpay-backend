"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.evmBasedWeb3 = void 0;
const tslib_1 = require("tslib");
const web3_1 = tslib_1.__importDefault(require("web3"));
const api_client_1 = require("@tatumio/api-client");
const shared_core_1 = require("@tatumio/shared-core");
const bignumber_js_1 = tslib_1.__importDefault(require("bignumber.js"));
const evmBasedWeb3 = (args) => {
    const getClient = (provider, fromPrivateKey) => {
        let web3;
        if (args === null || args === void 0 ? void 0 : args.client) {
            web3 = args === null || args === void 0 ? void 0 : args.client;
        }
        else {
            const endpoint = shared_core_1.httpHelper.rpcEndpoint(args.blockchain, api_client_1.OpenAPI.BASE, api_client_1.TATUM_API_CONSTANTS.API_KEY);
            web3 = new web3_1.default(provider || endpoint);
        }
        if (fromPrivateKey) {
            web3.eth.accounts.wallet.add(fromPrivateKey);
            web3.eth.defaultAccount = web3.eth.accounts.wallet[0].address;
        }
        return web3;
    };
    return {
        getClient,
        getGasPriceInWei() {
            return tslib_1.__awaiter(this, void 0, void 0, function* () {
                const client = getClient();
                const gasPrice = yield client.eth.getGasPrice();
                return new bignumber_js_1.default(gasPrice).precision(8).toString();
            });
        },
    };
};
exports.evmBasedWeb3 = evmBasedWeb3;
//# sourceMappingURL=evm-based.web3.js.map